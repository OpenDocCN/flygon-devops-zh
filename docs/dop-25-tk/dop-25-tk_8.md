# 第八章：我们做了什么？

我们探讨了一些超出“正常”Kubernetes 使用范围的主题。我们学会了如何使用 HorizontalPodAutoscaler 来扩展 Pods。我们发现，如果不能扩展集群节点，扩展 Pods 并不能提供足够的好处。我们探讨了如何使用 Cluster Autoscaler 来做到这一点。不幸的是，目前它只适用于 AWS、GKE 和 AKS。

虽然扩展 Pods 和节点是必不可少的，但我们也需要收集指标。它们让我们了解集群和其中运行的应用程序的行为。为此，我们采用了 Prometheus。更重要的是，我们看到了如何利用 Alertmanager 创建通知，当出现问题时会提醒我们，而不是盯着屏幕等待图表达到“红线”。

我们了解到，仅从出口商那里收集指标可能不够，因此我们将我们的应用程序作为提供更低级别指标的一种方式，让我们深入了解我们应用程序的状态。

我们还探讨了 HorizontalPodAutoscaler 使用自定义指标的能力。我们将其连接到了 Prometheus，从而将扩展阈值扩展到几乎我们能想象的任何公式。

鉴于我们在 Prometheus 中收集指标，并且它不提供仪表板功能，我们将其连接到了 Grafana。在这个过程中，我们探讨了如何使仪表板比许多人本能地被吸引的传统“漂亮颜色”更有用。

最后，我们讨论了集中式日志记录的需求，以及一些可能帮助我们通过警报发现问题的工具。为此，我们评估了 Papertrail、AWS CloudWatch、GCP Stackdriver、Azure Log Analytics 和 Elasticsearch-Fluentd-Kibana（EFK）堆栈。

我们超越了常规的 Kubernetes 操作，成功使我们的集群更加健壮和可靠。我们迈出了一步，朝着大部分自适应系统迈进，这些系统只在无法自动解决的特殊情况下需要人工干预。当我们需要干预时，我们将装备所有必要的信息，以快速推断问题的原因并执行纠正措施，将我们的集群恢复到期望的状态。

# 贡献

像以前的书一样，这本书也是一次合作努力。许多人通过讨论、笔记和错误报告帮助塑造了这本书。我被*DevOps20* ([`slack.devops20toolkit.com/`](http://slack.devops20toolkit.com/)) Slack（通常是私人的）消息和电子邮件淹没在评论中。我与早期版本读者的交谈对最终结果产生了重大影响。我很感激有这样一个伟大的社区支持我。**谢谢你们帮助我打造这本伟大的书。**

有些人站在人群之上。

**Vadim Gusev** 帮助校对和讨论书籍结构，从初学者的角度出发。

用他自己的话说...

*Vadim 是一位年轻的 IT 专家，他从事网络工程师的职业生涯，但对云和容器的概念如此着迷，以至于决定转变自己的职业道路走向 DevOps。他在一家小型初创公司工作，并带领它走向光明的容器化未来，主要受到 Viktor 的书籍的指导。在业余时间，他喜欢锻炼身体，玩鼓，故意拖延。*

**Prageeth Warnak** 不断提交修正和建议的拉取请求。他使这本书比我依赖于我经常错误的假设读者期望的情况下更加清晰。

用他自己的话说...

*Prageeth 是一位经验丰富的 IT 专业人士，目前担任澳大利亚电信巨头 Telstra 的首席软件架构师。他喜欢使用新技术，并喜欢在闲暇时间阅读书籍（尤其是 Viktor 写的书），举重（他可以举起 180 公斤的重物），观看 Netflix 和 Fox 新闻（是的，他是一个原始主义者和保守派）。他与家人一起住在墨尔本。他着迷于正确实施微服务和 DevOps。*
