## 2：Docker

没有关于容器的书籍或对话是完整的，而不谈论 Docker。但是当有人说“Docker”时，他们可能指的是至少三件事中的任何一件：

1.  Docker，Inc.公司

1.  Docker 容器运行时和编排技术

1.  Docker 开源项目（现在称为 Moby）

如果你要在容器世界中取得成功，你需要了解这三者的一些情况。

### Docker - 简而言之

Docker 是在 Linux 和 Windows 上运行的软件。它创建、管理和编排容器。该软件作为 GitHub 上*Moby*开源项目的一部分在开放中开发。Docker，Inc.是一家总部位于旧金山的公司，是开源项目的整体维护者。Docker，Inc.还提供带有支持合同等商业版本的 Docker。

好的，这就是快速版本。现在我们将更详细地探讨每一个。我们还将谈一下容器生态系统，并提到开放容器倡议（OCI）。

### Docker，Inc.

Docker，Inc.是由法国出生的美国开发者和企业家 Solomon Hykes 创立的旧金山科技初创公司。

![图 2.1 Docker，Inc.标志。](img/figure2-1.png)

图 2.1 Docker，Inc.标志。

有趣的是，Docker，Inc.起初是作为一个名为*dotCloud*的平台即服务（PaaS）提供商开始其生活的。在幕后，dotCloud 平台利用了 Linux 容器。为了帮助他们创建和管理这些容器，他们建立了一个内部工具，最终将其昵称为“Docker”。这就是 Docker 诞生的方式！

2013 年，dotCloud PaaS 业务陷入困境，公司需要新的生机。为了帮助解决这个问题，他们聘请了新 CEO 本·戈鲁布，将公司重新品牌为“Docker，Inc.”，摆脱了 dotCloud PaaS 平台，并开始了一个新的旅程，使命是将 Docker 和容器带给世界。

今天，Docker，Inc.被广泛认为是一家创新技术公司，市值据一些人称在 10 亿美元左右。在撰写本文时，它已经通过几轮融资从硅谷风险投资界的一些最大的名字中筹集了超过 2.4 亿美元。几乎所有这些资金都是在公司转型成为*Docker，Inc.*之后筹集的。

自成为 Docker，Inc.以来，他们进行了几笔小规模收购，费用未公开，以帮助扩大他们的产品和服务组合。

在撰写本文时，Docker，Inc.大约有 300-400 名员工，并举办名为 Dockercon 的年度会议。Dockercon 的目标是汇集不断增长的容器生态系统，推动 Docker 和容器技术的采用。

在本书中，当提到 Docker 公司时，我们将使用术语“Docker，Inc.”。术语“Docker”的所有其他用法将指的是技术或开源项目。

> **注意：**“Docker”一词来自英国的俚语，意思是**dock** work__er__ ——负责装卸船货的人。

### Docker 运行时和编排引擎

当大多数*技术人员*谈论 Docker 时，他们指的是*Docker Engine*。

*Docker Engine*是运行和编排容器的基础设施管道软件。如果你是 VMware 管理员，你可以把它想象成类似于 ESXi。就像 ESXi 是运行虚拟机的核心 hypervisor 技术一样，Docker Engine 是运行容器的核心容器运行时。

所有其他 Docker，Inc.和第三方产品都插入到 Docker Engine 中并围绕它构建。图 2.2 显示了 Docker Engine 位于中心。图表中的所有其他产品都建立在引擎之上，并利用其核心能力。

![图 2.2](img/figure2-2.png)

图 2.2

Docker Engine 可以从 Docker 网站下载或从 GitHub 源代码构建。它在 Linux 和 Windows 上都可用，并提供开源和商业支持的产品。

在撰写本文时，有两个主要版本：

+   企业版（EE）

+   社区版（CE）

企业版和社区版都有一个稳定的发布渠道，每季度发布一次。每个社区版将得到 4 个月的支持，每个企业版将得到 12 个月的支持。

社区版通过*edge*渠道每月发布一次。

从 2017 年第一季度开始，Docker 版本号遵循 YY.MM-xx 版本方案，类似于 Ubuntu 和其他项目。例如，2018 年 6 月的第一个社区版发布将是 18.06.0-ce。

> **注意：**在 2017 年第一季度之前，Docker 版本号遵循`major.minor`版本方案。新方案之前的最后一个版本是 Docker 1.13。

### Docker 开源项目（Moby）

“Docker”一词也用来指代开源的*Docker 项目*。这是一组工具，可以组合成 Docker 守护程序和客户端，您可以从 docker.com 下载并安装。然而，该项目在 2017 年在德克萨斯州奥斯汀举行的 DockerCon 上正式更名为*Moby*项目。作为更名的一部分，GitHub 存储库从 docker/docker 迁移到了 moby/moby，并且该项目有了自己的标志。

![](img/figure2-3.png)

Moby 项目的目标是成为 Docker 的*上游*，并将 Docker 分解为更多的模块化组件，并在开放环境中进行此操作。它托管在 GitHub 上，您可以在 https://github.com/moby 上看到 Moby 存储库中包括的当前子项目和工具的列表。核心*Docker Engine*项目目前位于 https://github.com/moby/moby，但引擎的更多部分正在不断地分解和模块化。

作为一个开源项目，源代码是公开可用的，您可以自由下载、贡献、调整和使用它，只要您遵守[Apache License 2.0](https://github.com/docker/docker/blob/master/LICENSE)的条款。

如果您花时间查看该项目的提交历史，您会看到基础设施技术的权威人士，包括 RedHat、微软、IBM、思科和 HPE。您还会看到与大公司无关的个人的名字。

该项目及其工具的大部分都是用*Golang*编写的——这是谷歌的相对较新的系统级编程语言，也被称为*Go*。如果您使用 Go 编码，您就有很好的机会为该项目做出贡献！

Moby/Docker 作为一个开源项目的一个好处是，它的很多部分都是在开放环境中开发和设计的。这消除了很多以前的方式，其中代码是专有的并且被锁在闭门之后。这也意味着发布周期是公开发布并在开放环境中进行工作。不再有不确定的发布周期，这些周期被保密，然后提前数月进行荒谬的炫耀和庆典。Moby/Docker 项目不是这样工作的。大多数事情都是公开进行的，所有人都可以看到并做出贡献。

Moby 项目和更广泛的 Docker 运动是庞大且势头迅猛的。它有数千个 GitHub 拉取请求，数万个 Docker 化项目，更不用说来自 Docker Hub 的数十亿次镜像拉取。该项目确实正在席卷整个行业！

毫无疑问，Docker 正在被使用！

### 容器生态系统

Docker, Inc.的核心理念之一经常被称为“包含但可移除的电池”。

这是一种说法，意思是你可以用第三方的“东西”替换掉很多原生的 Docker“东西”。一个很好的例子是网络堆栈。核心 Docker 产品内置了网络。但网络堆栈是可插拔的，意味着你可以摘掉原生的 Docker 网络，用第三方的东西替换它。很多人都这样做。

在早期，第三方插件通常比随 Docker 一起提供的原生插件更好。然而，这给 Docker, Inc.带来了一些商业模式上的挑战。毕竟，Docker, Inc.必须在某个时候盈利才能成为一个可行的长期业务。因此，*包含*的电池变得越来越好。这引起了生态系统内的紧张和竞争加剧。

长话短说，原生的 Docker 电池仍然是可移除的，只是越来越少地**需要**移除它们。

尽管如此，容器生态系统在合作和竞争之间取得了健康的平衡。你经常会听到人们使用“合作竞争”（合作和竞争的平衡）和“敌友”（朋友和敌人的混合）这样的术语来谈论容器生态系统。这很棒！**健康的竞争是创新之母！**

### 开放容器倡议（OCI）

谈论 Docker 和容器生态系统时，不能不提到[Open Containers Initiative — OCI](https://www.opencontainers.org)。

![](img/figure2-4.png)

OCI 是一个负责标准化容器基础设施最基本组件的治理委员会，比如*镜像格式*和*容器运行时*（如果这些术语对你来说是新的，我们会在书中介绍它们）。

同样，谈论 OCI 也不能完整，没有提到一点历史。和所有历史记载一样，你得到的版本取决于谁在说话。所以，这是 Nigel 对容器历史的看法 :-D

从一开始，Docker 的使用就像疯狂一样增长。越来越多的人以越来越多的方式使用它来做越来越多的事情。因此，某些方面感到沮丧是不可避免的。这是正常和健康的。

根据尼格尔的*历史概述*，一个叫做[CoreOS](https://coreos.com)的公司不喜欢 Docker 做某些事情的方式。所以他们采取了行动！他们创建了一个叫做**[appc](https://github.com/appc/spec/)**的新的开放标准，定义了像图像格式和容器运行时这样的东西。他们还创建了一个叫做**rkt**（发音为“火箭”）的规范实现。

这使得容器生态系统处于尴尬的境地，有两个竞争性的标准。

回到故事，这威胁着破坏生态系统，并给用户和客户带来了两难选择。虽然竞争通常是件好事，但是*竞争性标准*通常不是。它们会导致混乱并减缓用户采用速度。对任何人都不利。

有了这个想法，每个人都尽力表现得像成年人一样，走到一起组成了 OCI - 一个轻量敏捷的委员会来管理容器标准。

在撰写本文时，OCI 已经发布了两个规范（标准）-

+   [image-spec](https://github.com/opencontainers/image-spec)

+   [runtime-spec](https://github.com/opencontainers/runtime-spec)

在提到这两个标准时经常使用的类比是*铁轨*。这两个标准就像是对铁轨的标准尺寸和属性达成一致。其他人可以自由地建造更好的火车、更好的车厢、更好的信号系统、更好的车站……都可以放心地知道它们将在标准化的铁轨上运行。没有人希望有两个竞争性的铁轨尺寸标准！

可以说，OCI 的两个规范对核心 Docker 产品的架构和设计产生了重大影响。截至 Docker 1.11，Docker 引擎架构符合 OCI 运行时规范。

到目前为止，OCI 已经取得了一些成就，并在一定程度上促进了生态系统的统一。然而，标准总是会减缓创新！特别是对于正在以接近光速发展的新技术。这导致了容器社区中一些激烈的争论和热烈的讨论。在作者看来，这是件好事！容器行业正在改变世界，处于前沿的人们热情、有主见，有时甚至有些离谱！期待更多关于标准和创新的*热烈讨论*！

OCI 是在 Linux 基金会的支持下组织起来的，Docker 公司和 CoreOS 公司都是主要的贡献者。

### 本章总结

在本章中，我们了解了一些关于 Docker，Inc.。他们是一家位于旧金山的初创科技公司，有改变我们软件开发方式的雄心壮志。他们可以说是容器现代革命的第一批推动者和发起者。但现在已经存在着一个庞大的合作伙伴和竞争对手生态系统。

Docker 项目是开源的，上游代码存放在 GitHub 上的`moby/moby`仓库中。

开放容器倡议（OCI）在标准化容器运行时格式和容器镜像格式方面发挥了重要作用。
