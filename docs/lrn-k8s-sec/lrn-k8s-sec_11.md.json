["```\n$ docker history kaizheh/anchore-cli\nIMAGE               CREATED             CREATED BY                                      SIZE                COMMENT\n76b8613d39bc        8 hours ago         /bin/sh -c #(nop) COPY file:92b27c0a57eddb63…   678B                \n38ea9049199d        10 hours ago        /bin/sh -c #(nop)  ENV PATH=/.local/bin/:/us…   0B                  \n525287c1340a        10 hours ago        /bin/sh -c pip install anchorecli               5.74MB              \nf0cbce9c40f4        10 hours ago        /bin/sh -c apt-get update && apt-get install…   423MB               \na2a15febcdf3        7 months ago        /bin/sh -c #(nop)  CMD [\"/bin/bash\"]            0B                  \n<missing>           7 months ago        /bin/sh -c mkdir -p /run/systemd && echo 'do…   7B                  \n<missing>           7 months ago        /bin/sh -c set -xe   && echo '#!/bin/sh' > /…   745B                \n<missing>           7 months ago        /bin/sh -c [ -z \"$(apt-get indextargets)\" ]     987kB               \n<missing>           7 months ago        /bin/sh -c #(nop) ADD file:c477cb0e95c56b51e…   63.2MB       \n```", "```\nFROM ubuntu\nRUN apt-get update && apt-get install -y python-pip jq vim\nRUN pip install anchorecli\nENV PATH=\"$HOME/.local/bin/:$PATH\"\nCOPY ./demo.sh /demo.sh\n```", "```\n$ helm install anchore-demo stable/anchore-engine\n```", "```\n$ kubectl get deploy\nNAME                                      READY   UP-TO-DATE   AVAILABLE   AGE\nanchore-demo-anchore-engine-analyzer      1/1     1            1           3m37s\nanchore-demo-anchore-engine-api           1/1     1            1           3m37s\nanchore-demo-anchore-engine-catalog       1/1     1            1           3m37s\nanchore-demo-anchore-engine-policy        1/1     1            1           3m37s\nanchore-demo-anchore-engine-simplequeue   1/1     1            1           3m37s\nanchore-demo-postgresql                   1/1     1            1           3m37s\n```", "```\nroot@anchore-cli:/# anchore-cli system status\n```", "```\nService analyzer (anchore-demo-anchore-engine-analyzer-5fd777cfb5-jtqp2, http://anchore-demo-anchore-engine-analyzer:8084): up\nService apiext (anchore-demo-anchore-engine-api-6dd475cf-n24xb, http://anchore-demo-anchore-engine-api:8228): up\nService policy_engine (anchore-demo-anchore-engine-policy-7b8f68fbc-q2dm2, http://anchore-demo-anchore-engine-policy:8087): up\nService simplequeue (anchore-demo-anchore-engine-simplequeue-6d4567c7f4-7sll5, http://anchore-demo-anchore-engine-simplequeue:8083): up\nService catalog (anchore-demo-anchore-engine-catalog-949bc68c9-np2pc, http://anchore-demo-anchore-engine-catalog:8082): up\nEngine DB Version: 0.0.12\nEngine Code Version: 0.6.1\n```", "```\nroot@anchore-cli:/# anchore-cli image add kaizheh/nginx-docker\n```", "```\nImage Digest: sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060bf7d66d877 6c1554b7\nParent Digest: sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060bf7d66d877 6c1554b7\nAnalysis Status: analyzed\nImage Type: docker\nAnalyzed At: 2020-03-22T05:48:14Z\nImage ID: bcf644d78ccd89f36f5cce91d205643a47c8a5277742c5b311c9d9 6699a3af82\nDockerfile Mode: Guessed\nDistro: debian\nDistro Version: 10\nSize: 1172316160\nArchitecture: amd64\nLayer Count: 16\nFull Tag: docker.io/kaizheh/nginx-docker:latest\nTag Detected At: 2020-03-22T05:44:38Z\n```", "```\nroot@anchore-cli:/# anchore-cli image get kaizheh/nginx-docker\n```", "```\nImage Digest: sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060bf7d66d877 6c1554b7\nParent Digest: sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060bf7d66d877 6c1554b7\nAnalysis Status: analyzed\nImage Type: docker\nAnalyzed At: 2020-03-22T05:48:14Z\nImage ID: bcf644d78ccd89f36f5cce91d205643a47c8a5277742c5b311c9d96699a3a f82\nDockerfile Mode: Guessed\nDistro: debian\nDistro Version: 10\nSize: 1172316160\nArchitecture: amd64\nLayer Count: 16\nFull Tag: docker.io/kaizheh/nginx-docker:latest\nTag Detected At: 2020-03-22T05:44:38Z\n```", "```\n{\n\t\"action\": \"WARN\",\n\t\"gate\": \"vulnerabilities\",\n\t\"id\": \"6063fdde-b1c5-46af-973a-915739451ac4\",\n\t\"params\": [{\n\t\t\t\"name\": \"package_type\",\n\t\t\t\"value\": \"all\"\n\t\t},\n\t\t{\n\t\t\t\"name\": \"severity_comparison\",\n\t\t\t\"value\": \"=\"\n\t\t},\n\t\t{\n\t\t\t\"name\": \"severity\",\n\t\t\t\"value\": \"medium\"\n\t\t}\n\t],\n\t\"trigger\": \"package\"\n},\n```", "```\n {\n \t\"action\": \"STOP\",\n \t\"gate\": \"vulnerabilities\",\n \t\"id\": \"b30e8abc-444f-45b1-8a37-55be1b8c8bb5\",\n \t\"params\": [{\n \t\t\t\"name\": \"package_type\",\n \t\t\t\"value\": \"all\"\n \t\t},\n \t\t{\n \t\t\t\"name\": \"severity_comparison\",\n \t\t\t\"value\": \">\"\n \t\t},\n \t\t{\n \t\t\t\"name\": \"severity\",\n \t\t\t\"value\": \"medium\"\n \t\t}\n \t],\n \t\"trigger\": \"package\"\n },\n```", "```\nroot@anchore-cli:/# anchore-cli --json evaluate check sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060bf7d66d877 6c1554b7 --tag docker.io/kaizheh/nginx-docker:latest\n```", "```\n[\n    {\n        \"sha256:416b695b09a79995b3f25501bf0c9b9620e82984132060 bf7d66d8776c1554b7\": {\n            \"docker.io/kaizheh/nginx-docker:latest\": [\n                {\n                    \"detail\": {},\n                    \"last_evaluation\": \"2020-03-22T06:19:44Z\",\n                    \"policyId\": \"2c53a13c-1765-11e8-82ef-235277 61d060\",\n                    \"status\": \"fail\"\n                }\n            ]\n        }\n    }\n]\n```", "```\nroot@anchore-cli:/# anchore-cli image vuln docker.io/kaizheh/nginx-docker:latest all\n```", "```\nVulnerability ID        Package                                                Severity          Fix                              CVE Refs                Vulnerability URL\nCVE-2019-9636           Python-2.7.16                                          Critical          None                             CVE-2019-9636           https://nvd.nist.gov/vuln/detail/CVE-2019-9636\nCVE-2020-7598           minimist-0.0.8                                         Critical          None                             CVE-2020-7598           https://nvd.nist.gov/vuln/detail/CVE-2020-7598\nCVE-2020-7598           minimist-1.2.0                                         Critical          None                             CVE-2020-7598           https://nvd.nist.gov/vuln/detail/CVE-2020-7598\nCVE-2020-8116           dot-prop-4.2.0                                         Critical          None                             CVE-2020-8116           https://nvd.nist.gov/vuln/detail/CVE-2020-8116\nCVE-2013-1753           Python-2.7.16                                          High              None                             CVE-2013-1753           https://nvd.nist.gov/vuln/detail/CVE-2013-1753\nCVE-2015-5652           Python-2.7.16                                          High              None                             CVE-2015-5652           https://nvd.nist.gov/vuln/detail/CVE-2015-5652\nCVE-2019-13404          Python-2.7.16                                          High              None                             CVE-2019-13404          https://nvd.nist.gov/vuln/detail/CVE-2019-13404\nCVE-2016-8660           linux-compiler-gcc-8-x86-4.19.67-2+deb10u1             Low               None                             CVE-2016-8660           https://security-tracker.debian.org/tracker/CVE-2016-8660\nCVE-2016-8660           linux-headers-4.19.0-6-amd64-4.19.67-2+deb10u1         Low               None                             CVE-2016-8660           https://security-tracker.debian.org/tracker/CVE-2016-8660\n```", "```\nname: CI\n...\n  build:\n    runs-on: ubuntu-latest\n    steps:\n    # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it\n    - uses: actions/checkout@v2\n    # Runs a set of commands using the runners shell\n    - name: Build and Push\n      env:\n        DOCKER_SECRET: ${{ secrets.DOCKER_SECRET }} \n      run: |\n        cd master/chapter9 && echo \"Build Docker Image\"\n        docker login -u kaizheh -p ${DOCKER_SECRET}\n        docker build -t kaizheh/anchore-cli . && docker push kaizheh/anchore-cli\n    - name: Scan\n      env:\n        ANCHORE_CLI_URL: ${{ secrets.ANCHORE_CLI_URL }} \n        ANCHORE_CLI_USER:  ${{ secrets.ANCHORE_CLI_USER }}\n        ANCHORE_CLI_PASS:  ${{ secrets.ANCHORE_CLI_PASS }}\n      run: |      \n        pip install anchorecli            # install anchore-cli\n        export PATH=\"$HOME/.local/bin/:$PATH\"       \n        img=\"kaizheh/anchore-cli\"\n        anchore-cli image add $img        # add image\n        sha=$(anchore-cli --json --api-version=0.2.4 image get $img | jq .[0].imageDigest -r)                   # get sha value\n        anchore-cli image wait $img       # wait for image analyzed\n        anchore-cli --json evaluate check $sha --tag $img # evaluate       \n    - name: Post Scan\n      run: |\n        # Slack to notify developers scan result or invite new reviewer if failed\n        exit 1  # purposely ends here\n```", "```\n$ make deploy\n```", "```\nNAME                                              READY   STATUS    RESTARTS   AGE\npod/image-scan-k8s-webhook-controller-manager-0   1/1     Running   1          16s\nNAME                                                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE\nservice/image-scan-k8s-webhook-controller-manager-service   ClusterIP   100.69.225.172   <none>        443/TCP   16s\nservice/webhook-server-service                              ClusterIP   100.68.111.117   <none>        443/TCP   8s\nNAME                                                         READY   AGE\nstatefulset.apps/image-scan-k8s-webhook-controller-manager   1/1     16s\n```", "```\napiVersion: admissionregistration.k8s.io/v1beta1\nkind: ValidatingWebhookConfiguration\nmetadata:\n  name: validating-webhook-configuration\nwebhooks:\n- name: validating-create-pods.k8s.io\n  clientConfig:\n    service:\n      namespace: image-scan-k8s-webhook-system\n      name: webhook-server-service\n      path: /validating-create-pods\n    caBundle: {{CA_BUNDLE}}\n  rules:\n  - operations:\n    - CREATE\n    apiGroups:\n    - \"\"\n    apiVersions:\n    - \"v1\"\n    resources:\n    - pods\n  failurePolicy: Fail\n```", "```\n$ make test\n```", "```\n+ kubectl run --image=bitnami/nginx --restart=Never nginx\npod/nginx created\n+ kubectl run --image=kaizheh/apache-struts2-cve-2017-5638 --restart=Never apache-struts2\nError from server (Image failed policy check: kaizheh/apache-struts2-cve-2017-5638): admission webhook \"validating-create-pods.k8s.io\" denied the request: Image failed policy check: kaizheh/apache-struts2-cve-2017-5638\n+ kubectl run --image=alpine:3.2 --restart=Never alpine\npod/alpine created\n```"]