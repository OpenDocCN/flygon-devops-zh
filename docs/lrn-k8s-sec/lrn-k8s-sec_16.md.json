["```\nkubectl cp /tmp/test <pod>:/tmp/bar\n```", "```\nkubectl cp <some-pod>:/tmp/foo /tmp/bar\n```", "```\n$ curl https://storage.googleapis.com/kubernetes-release/release/stable.txt\nv1.18.3\n```", "```\ndeny[reason] {\n  input.request.kind.kind == \"PodExecOptions\"\n  input.request.resource.resource == \"pods\"\n  input.request.subResource == \"exec\"\n  input.request.object.command[0] == \"tar\"\n  reason = sprintf(\"kubectl cp was detected on %v/%v by user: %v\", [\n    input.request.namespace,\n    input.request.object.container,\n    input.request.userInfo.username])\n}\n```", "```\nspec:\n    securityContext:\n        readOnlyRootFilesystem: true\n```", "```\n- rule: Write below monitored dir\n  desc: an attempt to write to any file below a set of binary directories\n  condition: >\n    evt.dir = < and open_write and monitored_dir\n    and not package_mgmt_procs\n    and not coreos_write_ssh_dir\n    and not exe_running_docker_save\n    and not python_running_get_pip\n    and not python_running_ms_oms\n    and not google_accounts_daemon_writing_ssh\n    and not cloud_init_writing_ssh\n    and not user_known_write_monitored_dir_conditions\n  output: >\n    File below a monitored directory opened for writing (user=%user.name\n    command=%proc.cmdline file=%fd.name parent=%proc.pname pcmdline=%proc.pcmdline gparent=%proc.aname[2] container_id=%container.id image=%container.image.repository)\n  priority: ERROR\n  tags: [filesystem, mitre_persistence]\n```", "```\n- macro: safe_kubectl_version\n  condition: (jevt.value[/userAgent] startswith \"kubectl/v1.15\" or\n              jevt.value[/userAgent] startswith \"kubectl/v1.14.3\" or\n              jevt.value[/userAgent] startswith \"kubectl/v1.14.2\" or\n              jevt.value[/userAgent] startswith \"kubectl/v1.13.7\" or\n              jevt.value[/userAgent] startswith \"kubectl/v1.13.6\" or\n              jevt.value[/userAgent] startswith \"kubectl/v1.12.9\")\n# CVE-2019-1002101\n# Run kubectl version --client and if it does not say client version 1.12.9,\n1.13.6, or 1.14.2 or newer,  you are running a vulnerable version.\n- rule: K8s Vulnerable Kubectl Copy\n  desc: Detect any attempt vulnerable kubectl copy in pod\n  condition: kevt_started and pod_subresource and kcreate and\n             ka.target.subresource = \"exec\" and ka.uri.param[command] = \"tar\" and\n             not safe_kubectl_version\n  output: Vulnerable kubectl copy detected (user=%ka.user.name pod=%ka.target.name ns=%ka.target.namespace action=%ka.target.subresource command=%ka.uri.param[command] userAgent=%jevt.value[/userAgent])\n  priority: WARNING\n  source: k8s_audit\n  tags: [k8s]\n```", "```\nspec:\n  template:\n    spec:\n      containers:\n      - name: db\n        image: redis\n```", "```\ncontainer_memory_max_usage_bytes{pod_ name=\"kube-apiserver-xxx\" }\nsum(rate(container_cpu_usage_seconds_total{pod_name=\"kube-apiserver-xxx\"}[5m]))\nsum(rate(container_network_receive_bytes_total{pod_name=\"kube-apiserver-xxx\"}[5m]))\n```", "```\nkops create cluster k8s-clusters.k8s-demo-zone.com \\\n  --cloud aws \\\n  --node-count 3 \\\n  --zones $ZONES \\\n  --node-size $NODE_SIZE \\\n  --master-size $MASTER_SIZE \\\n  --master-zones $ZONES \\\n  --networking calico \\\n  --kubernetes-version 1.14.3 \\\n  --yes \\\nkube-apiserver-ip-172-20-43-65.ec2.internal              1/1     Running   4          4h16m\nkube-apiserver-ip-172-20-67-151.ec2.internal             1/1     Running   4          4h15m\n```", "```\nkubectl auth reconcile -f rbac.yaml --remove-extra-subjects --remove-extra-permissions\nkubectl annotate --overwrite clusterrolebinding/system:basic-user rbac.authorization.kubernetes.io/autoupdate=false \n```", "```\n  apiVersion: audit.k8s.io/v1 # This is required.\n      kind: Policy\n      rules:\n      - level: RequestResponse\n        verbs: [\"patch\", \"update\", \"delete\"]\n        resources:\n        - group: \"\"\n          resources: [\"pods\"]\n          namespaces: [\"kube-system\", \"monitoring\"]\n```", "```\n$git clone https://github.com/aquasecurity/kube-hunter\n```", "```\n$ ./kubectl create -f job.yaml\n```", "```\n$ ./kubectl get pods\nNAME                READY   STATUS              RESTARTS   AGE\nkube-hunter-7hsfc   0/1     ContainerCreating   0          12s\n```"]