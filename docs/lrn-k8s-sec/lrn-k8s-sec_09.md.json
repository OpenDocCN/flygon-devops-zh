["```\n$ps aux | grep api\nroot      3701  6.1  8.7 497408 346244 ?       Ssl  21:06   0:16 kube-apiserver --advertise-address=192.168.99.111 --allow-privileged=true --anonymous-auth=false\n```", "```\nkube-apiserver --advertise-address=192.168.99.104 --allow-privileged=true --authorization-mode=Node,RBAC --client-ca-file=/var/lib/minikube/certs/ca.crt\n```", "```\nopenssl genrsa -out priv.key 4096\n```", "```\n[ req ]\ndefault_bits = 2048\nprompt = no\ndefault_md = sha256\ndistinguished_name = dn\n[ dn ]\nCN = test\nO = dev\n[ v3_ext ]\nauthorityKeyIdentifier=keyid,issuer:always basicConstraints=CA:FALSE\nkeyUsage=keyEncipherment,dataEncipherment extendedKeyUsage=serverAuth,clientAuth\n```", "```\nopenssl req -config ./csr.cnf -new -key priv.key -nodes -out new.csr\n```", "```\napiVersion: certificates.k8s.io/v1beta1\nkind: CertificateSigningRequest\nmetadata:\n name: mycsr\nspec:\n groups:\n - system:authenticated\n request: ${BASE64_CSR}\n usages:\n - digital signature\n - key encipherment\n - server auth\n - client auth\n```", "```\n$ export BASE64_CSR=$(cat ./new.csr | base64 | tr -d '\\n')\n$ cat csr.yaml | envsubst | kubectl apply -f -\n```", "```\nkubectl certificate approve mycsr\n```", "```\nkubectl get csr mycsr -o jsonpath='{.status.certificate}' \\\n | base64 --decode > new.crt\n```", "```\nAuthorization: Bearer 66e6a781-09cb-4e7e-8e13-34d78cb0dab6\n```", "```\nAuthentication: Basic base64(user:password)\n```", "```\n$ps aux | grep api\nroot      3701  3.8  8.8 497920 347140 ?       Ssl  21:06   4:58 kube-apiserver --advertise-address=192.168.99.111 --allow-privileged=true --anonymous-auth=true --authorization-mode=Node,RBAC --client-ca-file=/var/lib/minikube/certs/ca.crt --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota --enable-bootstrap-token-auth=true\n```", "```\n$ ps aux | grep controller\nroot      3693  1.4  2.3 211196 94396 ?        Ssl  21:06   1:55 kube-controller-manager --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf --bind-address=127.0.0.1 --client-ca-file=/var/lib/minikube/certs/ca.crt --cluster-name=mk --cluster-signing-cert-file=/var/lib/minikube/certs/ca.crt --cluster-signing-key-file=/var/lib/minikube/certs/ca.key --controllers=*,bootstrapsigner,tokencleaner\n```", "```\nAuthorization: Bearer 123456.aa1234fdeffeeedf\n```", "```\n$ps aux | grep api\nroot      3711 27.1 14.9 426728 296552 ?       Ssl  04:22   0:04 kube-apiserver --advertise-address=192.168.99.104 ... --secure-port=8443 --service-account-key-file=/var/lib/minikube/certs/sa.pub --service-cluster-ip-range=10.96.0.0/12 --tls-cert-file=/var/lib/minikube/certs/apiserver.crt --tls-private-key-file=/var/lib/minikube/certs/apiserver.key\ndocker    4496  0.0  0.0  11408   544 pts/0    S+   04:22   0:00 grep api\n```", "```\nkubectl create serviceaccount test \n```", "```\n$ kubectl get serviceaccounts test -o yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  creationTimestamp: \"2020-03-29T04:35:58Z\"\n  name: test\n  namespace: default\n  resourceVersion: \"954754\"\n  selfLink: /api/v1/namespaces/default/serviceaccounts/test\n  uid: 026466f3-e2e8-4b26-994d-ee473b2f36cd\nsecrets:\n- name: test-token-sdq2d\n```", "```\n$ kubectl get secret test-token-sdq2d -o yaml\napiVersion: v1\ndata:\n  ca.crt: base64(crt)\n  namespace: ZGVmYXVsdA==\n  token: base64(token)\nkind: Secret\n```", "```\nclusters:\n  - name: name-of-remote-authn-service\n    cluster:\n      certificate-authority: /path/to/ca.pem\n      server: https://authn.example.com/authenticate\n```", "```\n--requestheader-username-headers=X-Remote-User\n--requestheader-group-headers=X-Remote-Group\n--requestheader-extra-headers-prefix=X-Remote-Extra-\n```", "```\nGET / HTTP/1.1\nX-Remote-User: foo\nX-Remote-Group: bar\nX-Remote-Extra-Scopes: profile\n```", "```\nkubectl apply -f pod.yaml --as=dev-user --as-group=system:dev\n```", "```\n$ps aux | grep api\nroot      3701  6.1  8.7 497408 346244 ?       Ssl  21:06   0:16 kube-apiserver --advertise-address=192.168.99.111 --allow-privileged=true --anonymous-auth=true --authorization-mode=Node,RBAC --client-ca-file=/var/lib/minikube/certs/ca.crt --enable-admission-plugins=NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota\n```", "```\n{\"apiVersion\": \"abac.authorization.kubernetes.io/v1beta1\", \"kind\": \"Policy\", \"spec\": {\"user\": \"kubelet\", \"namespace\": \"*\", \"resource\": \"pods\", \"readonly\": true}} \n```", "```\n$ ps aux | grep api\nroot     14632  9.2 17.0 495148 338780 ?       Ssl  06:11   0:09 kube-apiserver --advertise-address=192.168.99.104 --allow-privileged=true --authorization-mode=Node,RBAC ...\n```", "```\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  namespace: default\n  name: deployment-manager\nrules:\n- apiGroups: [\"\"]\n  resources: [\"pods\"]\n  verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\", \"delete\"]\n```", "```\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  name: binding\n  namespace: default\nsubjects:\n- kind: User\n  name: employee\n  apiGroup: \"\"\nroleRef:\n  kind: Role\n  name: deployment-manager\n  apiGroup: \"\"\n```", "```\n$ kubectl --context=employee-context get pods\nNAME                          READY   STATUS    RESTARTS   AGE\nhello-node-677b9cfc6b-xks5f   1/1     Running   0          12m\n```", "```\n$ kubectl --context=employee-context get deployments\nError from server (Forbidden): deployments.apps is forbidden: User \"employee\" cannot list resource \"deployments\" in API group \"apps\" in the namespace \"default\"\n```", "```\n$ kubectl --context=employee-context get pods -n test\nError from server (Forbidden): pods is forbidden: User \"test\" cannot list resource \"pods\" in API group \"\" in the namespace \"test\"\n$ kubectl --context=employee-context get pods -n kube-system\nError from server (Forbidden): pods is forbidden: User \"test\" cannot list resource \"pods\" in API group \"\" in the namespace \"kube-system\"\n```", "```\nclusters:\n  - name: authz_service\n    cluster:\n      certificate-authority: ca.pem\n      server: https://authz.remote/\n```", "```\n$ps aux | grep api\nroot      3460 17.0  8.6 496896 339432 ?       Ssl  06:53   0:09 kube-apiserver --advertise-address=192.168.99.106 --allow-privileged=true --authorization-mode=Node,RBAC --client-ca-file=/var/lib/minikube/certs/ca.crt --enable-admission-plugins=PodSecurityPolicy,NamespaceLifecycle,LimitRanger --enable-bootstrap-token-auth=true\n```", "```\nlimits:\n- type: Namespace\n  qps: 50\n  burst: 100\n  cacheSize: 200\n- type: Server\n  qps: 10\n  burst: 50\n  cacheSize: 200\n```", "```\napiVersion: \"v1\"\nkind: \"LimitRange\"\nmetadata:\n  name: \"pod-example\" \nspec:\n  limits:\n    - type: \"Pod\"\n      max:\n        memory: \"128Mi\"\n```", "```\npods \"range-demo\" is forbidden maximum memory usage per Pod is 128Mi, but limit is 1073741824\n```", "```\n$ ps aux | grep api\nroot      3763  6.7  8.7 497344 345404 ?       Ssl  23:28   0:14 kube-apiserver --advertise-address=192.168.99.112 --allow-privileged=true --authorization-mode=Node,RBAC --client-ca-file=/var/lib/minikube/certs/ca.crt --enable-admission-plugins=SecurityContextDeny\n```", "```\n$ cat pod-blacklist.rego\npackage kubernetes.admission\nimport data.kubernetes.namespaces\noperations = {\"CREATE\", \"UPDATE\"}\ndeny[msg] {\n\tinput.request.kind.kind == \"Pod\"\n\toperations[input.request.operation]\n\timage := input.request.object.spec.containers[_].image\n\timage == \"busybox\"\n\tmsg := sprintf(\"image not allowed %q\", [image])\n}\n```", "```\nkubectl create configmap pod —from-file=pod-blacklist.rego\n```", "```\n$ cat busybox.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: busybox\nspec:\n  containers:\n  - name: sec-ctx-demo\n    image: busybox\n    command: [ \"sh\", \"-c\", \"sleep 1h\" ]\n```", "```\nadmission webhook \"validating-webhook.openpolicyagent.org\" denied the request: image not allowed \"busybox\"\n```"]