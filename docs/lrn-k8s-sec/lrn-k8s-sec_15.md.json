["```\n$ kubectl get pods -n insecure-nginx\nNAME                              READY   STATUS    RESTARTS   AGE\ninsecure-nginx-8455b6d49c-z6wb9   1/1     Running   0          163m\n```", "```\nroot@insecure-nginx-8455b6d49c-z6wb9:/# ls /tmp\nminerd2  perg\n```", "```\n- list: miner_ports\n  items: [\n        25, 3333, 3334, 3335, 3336, 3357, 4444,\n        5555, 5556, 5588, 5730, 6099, 6666, 7777,\n        7778, 8000, 8001, 8008, 8080, 8118, 8333,\n        8888, 8899, 9332, 9999, 14433, 14444,\n        45560, 45700\n    ]\n- list: miner_domains\n  items: [\n      \"Asia1.ethpool.org\",\"ca.minexmr.com\", \"monero.crypto-pool.fr\",\n      ...\n      \"xmr-jp1.nanopool.org\",\"xmr-us-east1.nanopool.org\",\n      \"xmr-us-west1.nanopool.org\",\"xmr.crypto-pool.fr\",\n      \"xmr.pool.minergate.com\"\n      ]\n```", "```\n- macro: minerpool_other\n  condition: (fd.sport in (miner_ports) and fd.sip.name in (miner_domains))\n```", "```\n- macro: net_miner_pool\n  condition: (evt.type in (sendto, sendmsg) and evt.dir=< and (fd.net != \"127.0.0.0/8\" and not fd.snet in (rfc_1918_addresses)) and ((minerpool_http) or (minerpool_https) or (minerpool_other)))\n```", "```\n# The rule is disabled by default.\n# Note: Falco will send DNS requests to resolve miner pool domains which may trigger alerts in your environment.\n- rule: Detect outbound connections to common miner pool ports\n  desc: Miners typically connect to miner pools on common ports.\n  condition: net_miner_pool and not trusted_images_query_miner_domain_dns\n  enabled: true\n  output: Outbound connection to IP/Port flagged by cryptoioc.ch (command=%proc.cmdline port=%fd.rport ip=%fd.rip container=%container.info image=%container.image.repository)\n  priority: CRITICAL\n  tags: [network, mitre_execution]\n```", "```\n19:46:37.939287649: Critical Outbound connection to IP/Port flagged by cryptoioc.ch (command=minerd2 -a cryptonight -o stratum+tcp://monero.crypto-pool.fr:3333 -u 49TfoHGd6apXxNQTSHrMBq891vH6JiHmZHbz5Vx36nLRbz6WgcJunTtgcxno G6snKFeGhAJB5LjyAEnvhBgCs5MtEgML3LU -p x port=37110 ip=100.97.244.198 container=k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 image=kaizheh/victim) k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100\n```", "```\n- list: trusted_server_addresses\n  items: [...]\n- list: trusted_server_ports\n  items: [...]\n- rule: Detect anomalous outbound connections \n  desc: Detect anomalous outbound connections\n  condition: (evt.type in (sendto, sendmsg) and container and evt.dir=< and (fd.net != \"127.0.0.0/8\" and not fd.snet in (trusted_server_addresses) or not fd.sport in (trusted_server_ports))) \n  output: Outbound connection to anomalous IP/Port(command=%proc.cmdline port=%fd.rport ip=%fd.rip container=%container.info image=%container.image.repository)\n  priority: CRITICAL\n```", "```\n- rule: Detect crypto miners using the Stratum protocol\n  desc: Miners typically specify the mining pool to connect to with a URI that begins with 'stratum+tcp'\n  condition: spawned_process and proc.cmdline contains \"stratum+tcp\"\n  output: Possible miner running (command=%proc.cmdline container=%container.info image=%container.image.repository)\n  priority: CRITICAL\n  tags: [process, mitre_execution]\n```", "```\n19:46:37.779784798: Critical Possible miner running (command=minerd2 -a cryptonight -o stratum+tcp://monero.crypto-pool.fr:3333 -u 49TfoHGd6apXxNQTSHrMBq891vH6JiHmZHbz5Vx36 nLRbz6WgcJunTtgcxnoG6snKFeGhAJB5LjyAEnvhBgCs5MtEgML3LU -p x container=k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 image=kaizheh/victim) k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100 k8s.ns=insecure-nginx k8s.pod=insecure-nginx-8455b6d49c-z6wb9 container=07dce07d5100\n```", "```\n- list: trusted_nginx_processes\n  items: [\"nginx\"]\n- rule: Detect Anomalous Process Launched in Nginx Container\n  desc: Anomalous process launched inside container.\n  condition: spawned_process and container and not proc.name in (trusted_nginx_processes) and image.repository.name=\"nginx\"\n  output: Anomalous process running in Nginx container (command=%proc.cmdline container=%container.info image=%container.image.repository)\n  priority: CRITICAL\n  tags: [process]\n```", "```\nroot@anchore-cli:/# anchore-cli --json image content kaizheh/victim:nginx files | jq '.content | .[] | select(.filename==\"/tmp/minerd2\")'\n{\n  \"filename\": \"/tmp/minerd2\",\n  \"gid\": 0,\n  \"linkdest\": null,\n  \"mode\": \"00755\",\n  \"sha256\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362 c07389d71bc728\",\n  \"size\": 183048,\n  \"type\": \"file\",\n  \"uid\": 0\n}\n```", "```\n$ curl -H \"Content-Type: application/json\" \"https://www.virustotal.com/vtapi/v2/file/report?apikey=$VIRUS_FEEDS_API_KEY&resource=e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a 362c07389d71bc728\" | jq .\n```", "```\n{\n  \"scans\": {\n    \"Fortinet\": {\n      \"detected\": true,\n      \"version\": \"6.2.142.0\",\n      \"result\": \"Riskware/CoinMiner\",\n      \"update\": \"20200413\"\n    },\n    ...\n    \"Antiy-AVL\": {\n      \"detected\": true,\n      \"version\": \"3.0.0.1\",\n      \"result\": \"RiskWare[RiskTool]/Linux.BitCoinMiner.a\",\n      \"update\": \"20200413\"\n    },\n  },\n  ...\n  \"resource\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362c07389d71bc 728\",\n  \"scan_date\": \"2020-04-13 18:22:56\",\n  \"total\": 60,\n  \"positives\": 25,\n  \"sha256\": \"e86db6abf96f5851ee476eeb8c847cd73aebd0bd903827a362c07389d71bc 728\",\n }\n```"]