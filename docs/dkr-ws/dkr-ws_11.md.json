["```\nRUN addgroup --gid <GID> <UID> && adduser <UID> -h <home_directory> --disabled-password --uid <UID> --ingroup <UID> <user_name>\n```", "```\nUSER <UID>\n```", "```\n1 FROM alpine\n2\n3 RUN apk update\n4 RUN apk add wget curl nmap libcap\n5\n6 RUN echo \"#!/sh\\n\" > test_memory.sh\n7 RUN echo \"cat /proc/meminfo; mpstat; pmap -x 1\"     >> test_memory.sh\n8 RUN chmod 755 test_memory.sh\n9\n10 CMD [\"sh\", \"test_memory.sh\"]\n```", "```\ndocker build -t security-app . ; docker run –rm security-app\n```", "```\nMemTotal:        2036900 kB\nMemFree:         1243248 kB\nMemAvailable:    1576432 kB\nBuffers:          73240 kB\n…\n```", "```\ndocker run --rm security-app whoami\n```", "```\nroot\n```", "```\ndocker run --rm -it security-app capsh –print\n```", "```\nCurrent: = cap_chown,cap_dac_override,cap_fowner,cap_fsetid,\ncap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_net_bind_service,\ncap_net_raw,cap_sys_chroot,cap_mknod,cap_audit_write,\ncap_setfcap+eip\ngroups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),\n11(floppy),20(dialout),26(tape),27(video)\n```", "```\ndocker run --rm -it security-app sh -c 'nmap -sS -p 443 localhost'\n```", "```\nStarting Nmap 7.70 ( https://nmap.org ) at 2019-11-13 02:40 UTC\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.000062s latency).\nOther addresses for localhost (not scanned): ::1\nPORT    STATE  SERVICE\n443/tcp closed https\nNmap done: 1 IP address (1 host up) scanned in 0.27 seconds\n```", "```\necho \"secret password\" > /tmp/secret.txt\n```", "```\nsudo chown root /tmp/secret.txt\n```", "```\ndocker run -v /tmp/secret.txt:/tmp/secret.txt security-app sh -c 'cat /tmp/secret.txt'\n```", "```\nsecret password\n```", "```\n1 FROM alpine\n2\n3 RUN apk update\n4 RUN apk add wget curl nmap libcap\n5\n6 RUN addgroup --gid 10001 20002 && adduser 20002 -h     /home/security_apps --disabled-password --uid 20002     --ingroup 20002\n7 WORKDIR /home/security_apps\n8\n9 USER 20002\n```", "```\n11 RUN echo \"#!/sh\\n\" > test_memory.sh\n12 RUN echo \"cat /proc/meminfo; mpstat; pmap -x 1\" >>     test_memory.sh\n13 RUN chmod 755 test_memory.sh\n14\n15 CMD [\"sh\", \"/home/security_apps/test_memory.sh\"]\n```", "```\nFROM alpine\nRUN apk update\nRUN apk add wget curl nmap libcap\nRUN addgroup --gid 10001 20002 && adduser 20002 -h   /home/security_apps --disabled-password --uid 20002     --ingroup 20002\nWORKDIR /home/security_apps\nUSER 20002\nRUN echo \"#!/sh\\n\" > test_memory.sh\nRUN echo \"cat /proc/meminfo; mpstat; pmap -x 1\" >>   test_memory.sh\nRUN chmod 755 test_memory.sh\nCMD [\"sh\", \"/home/security_apps/test_memory.sh\"]\n```", "```\ndocker build -t security-app . ; docker run --rm security-app whoami\n```", "```\n20002\n```", "```\ndocker run --rm -it security-app sh -c 'nmap -sS -p 443 localhost'\n```", "```\nYou requested a scan type which requires root privileges.\nQUITTING!\n```", "```\ndocker run -v /tmp/secret.txt:/tmp/secret.txt security-app sh -c 'cat /tmp/secret.txt'\n```", "```\ncat: can't open '/tmp/secret.txt': Permission denied\n```", "```\ndocker run –-cap-add|--cap-drop <capability_name> <image_name>\n```", "```\ndocker trust key generate <name>\n```", "```\ndocker trust key load <pem_key_file> –name <name>\n```", "```\ndocker trust sign <registry>/<repo>:<tag>\n```", "```\ndocker trust inspect –pretty <registry>/<repo>:<tag>\n```", "```\nexport DOCKER_CONTENT_TRUST=1\n```", "```\ndocker pull vincesestodocker/security-app\n```", "```\nUsing default tag: latest\nError: remote trust data does not exist for docker.io/vincesestodocker/security-app: notary.docker.io does \nnot have trust data for docker.io/vincesestodocker/security-app\n```", "```\ndocker push vincesestodocker/security-app\n```", "```\nThe push refers to repository \n[docker.io/vincesestodocker/security-app]\nNo tag specified, skipping trust metadata push\n```", "```\ndocker tag security-app:latest vincesestodocker/security-app:trust1\n```", "```\ndocker push vincesestodocker/security-app:trust1\n```", "```\nThe push refers to repository \n[docker.io/vincesestodocker/security-app]\neff6491f0d45: Layer already exists \n307b7a157b2e: Layer already exists \n03901b4a2ea8: Layer already exists \nver2: digest: sha256:7fab55c47c91d7e56f093314ff463b7f97968e\ne0f80f5ee927430fc39f525f66 size: 949\nSigning and pushing trust metadata\nYou are about to create a new root signing key passphrase. \nThis passphrase will be used to protect the most sensitive key \nin your signing system. Please choose a long, complex passphrase \nand be careful to keep the password and the key file itself \nsecure and backed up. It is highly recommended that you use a \npassword manager to generate the passphrase and keep it safe. \nThere will be no way to recover this key. You can find the key \nin your config directory.\nEnter passphrase for new root key with ID 66347fd: \nRepeat passphrase for new root key with ID 66347fd: \nEnter passphrase for new repository key with ID cf2042d: \nRepeat passphrase for new repository key with ID cf2042d: \nFinished initializing \"docker.io/vincesestodocker/security-app\"\nSuccessfully signed docker.io/vincesestodocker/security-app:\ntrust1\n```", "```\ndocker run -it vincesestodocker/security-app sh\n```", "```\ndocker: No valid trust data for latest.\nSee 'docker run --help'.\n```", "```\ndocker tag vincesestodocker/security-app:trust1 vincesestodocker/security-app:trust2\n```", "```\ndocker trust sign vincesestodocker/security-app:trust2\n```", "```\nSigning and pushing trust data for local image \nvincesestodocker/security-app:trust2, may overwrite remote \ntrust data\nThe push refers to repository \n[docker.io/vincesestodocker/security-app]\n015825f3a965: Layer already exists \n2c32d3f8446b: Layer already exists \n1bbb374ec935: Layer already exists \nbcc0069f86e9: Layer already exists \ne239574b2855: Layer already exists \nf5e66f43d583: Layer already exists \n77cae8ab23bf: Layer already exists \ntrust2: digest: sha256:a61f528324d8b63643f94465511132a38ff945083c\n3a2302fa5a9774ea366c49 size: 1779\nSigning and pushing trust metadataEnter passphrase for \nvincesestodocker key with ID f4b834e: \nSuccessfully signed docker.io/vincesestodocker/security-app:\ntrust2\n```", "```\ndocker trust inspect --pretty vincesestodocker/security-app:trust2\n```", "```\nSignatures for vincesestodocker/security-app:trust2\nSIGNED TAG      DIGEST                     SIGNERS\ntrust2          d848a63170f405ad3…         vincesestodocker\nList of signers and their keys for vincesestodocker/security-app:\ntrust2\nSIGNER              KEYS\nvincesestodocker    f4b834e54c71\nAdministrative keys for vincesestodocker/security-app:trust2\n  Repository Key:\n    26866c7eba348164f7c9c4f4e53f04d7072fefa9b52d254c573e8b082\n    f77c966\n  Root Key:\n    69bef52a24226ad6f5505fd3159f778d6761ac9ad37483f6bc88b1cb4\n    7dda334\n```", "```\ndocker trust revoke vincesestodocker/security-app:trust2\nEnter passphrase for vincesestodocker key with ID f4b834e: \nSuccessfully deleted signature for vincesestodocker/security-app:\ntrust2\n```", "```\nanchore-cli system status\n```", "```\nanchore-cli system feeds list\n```", "```\nanchore-cli registry add <registry> <user> <password>\n```", "```\nanchore-cli image add <repository_name>/<image_name>\n```", "```\nanchore-cli image vuln <repository_name>/<image_name> all\n```", "```\nanchore-cli evaluate check <repository_name>/<image_name>\n```", "```\ndocker tag security-app:latest vincesestodocker/security-app:scan1 ;\n```", "```\ndocker push vincesestodocker/security-app:scan1\n```", "```\nmkdir aevolume; cd aevolume\n```", "```\ncurl -O https://docs.anchore.com/current/docs/engine/quickstart/docker-compose.yaml\n```", "```\ndocker-compose pull\n```", "```\nPulling anchore-db           ... done\nPulling engine-catalog       ... done\nPulling engine-analyzer      ... done\nPulling engine-policy-engine ... done\nPulling engine-simpleq       ... done\nPulling engine-api           ... done\n```", "```\ndocker-compose up -d\n```", "```\nCreating network \"aevolume_default\" with the default driver\nCreating volume \"aevolume_anchore-db-volume\" with default driver\nCreating volume \"aevolume_anchore-scratch\" with default driver\nCreating aevolume_anchore-db_1 ... done\nCreating aevolume_engine-catalog_1 ... done\nCreating aevolume_engine-analyzer_1      ... done\nCreating aevolume_engine-simpleq_1       ... done\nCreating aevolume_engine-api_1           ... done\nCreating aevolume_engine-policy-engine_1 ... done\n```", "```\ndocker-compose ps\n```", "```\nCONTAINER ID       STATUS         PORTS\n    NAMES\nd48658f6aa77       (healthy)      8228/tcp\n    aevolume_engine-analyzer_1\ne4aec4e0b463   (healthy)          8228/tcp\n    aevolume_engine-policy-engine_1\nafb59721d890   (healthy)          8228->8228/tcp\n    aevolume_engine-api_1\nd61ff12e2376   (healthy)          8228/tcp\n    aevolume_engine-simpleq_1\nf5c29716aa40   (healthy)          8228/tcp\n    aevolume_engine-catalog_1\n398fef820252   (healthy)          5432/tcp\n    aevolume_anchore-db_1\n```", "```\npip3 install anchorecli; anchore-cli --version\n```", "```\nanchore-cli, version 0.5.0\n```", "```\nexport ANCHORE_CLI_URL=http://localhost:8228/v1\nexport ANCHORE_CLI_USER=admin\nexport ANCHORE_CLI_PASS=foobar\n```", "```\nanchore-cli system status\n```", "```\nService analyzer (anchore-quickstart, http://engine-analyzer:\n8228): up\nService simplequeue (anchore-quickstart, http://engine-simpleq:\n8228): up\nService policy_engine (anchore-quickstart, http://engine-policy-engine:8228): up\nService catalog (anchore-quickstart, http://engine-catalog:\n8228): up\nService apiext (anchore-quickstart, http://engine-api:8228): \nup\nEngine DB Version: 0.0.11\nEngine Code Version: 0.5.1\n```", "```\nanchore-cli system feeds list\n```", "```\nFeed                Group          LastSync\n    RecordCount\nnvdv2               nvdv2:cves     None\n    0\nvulnerabilities     alpine:3\\.      2019-10-24T03:47:28.504381\n    1485\nvulnerabilities     alpine:3.3     2019-10-24T03:47:36.658242\n    457\nvulnerabilities     alpine:3.4     2019-10-24T03:47:51.594635\n    681\nvulnerabilities     alpine:3.5     2019-10-24T03:48:03.442695\n    875\nvulnerabilities     alpine:3.6     2019-10-24T03:48:19.384824\n    1051\nvulnerabilities     alpine:3.7     2019-10-24T03:48:36.626534\n    1253\nvulnerabilities     alpine:3.8     None\n    0\nvulnerabilities     alpine:3.9     None\n    0\nvulnerabilities     amzn:2         None\n    0\n```", "```\nanchore-cli image add vincesestodocker/security-app:scan1\n```", "```\nImage Digest: sha256:7fab55c47c91d7e56f093314ff463b7f97968ee0\nf80f5ee927430\nfc39f525f66\nParent Digest: sha256:7fab55c47c91d7e56f093314ff463b7f97968ee\n0f80f5ee927430fc39f525f66\nAnalysis Status: not_analyzed\nImage Type: docker\nAnalyzed At: None\nImage ID: 8718859775e5d5057dd7a15d8236a1e983a9748b16443c99f8a\n40a39a1e7e7e5\nDockerfile Mode: None\nDistro: None\nDistro Version: None\nSize: None\nArchitecture: None\nLayer Count: None\nFull Tag: docker.io/vincesestodocker/security-app:scan1\nTag Detected At: 2019-10-24T03:51:18Z \n```", "```\nanchore-cli image list\n```", "```\nFull Tag               Image Digest            Analysis Status\nsecurity-app:scan1     sha256:a1bd1f6fec31…    analyzed\n```", "```\nanchore-cli image content vincesestodocker/security-app:scan1 os\n```", "```\nPackage                   Version        License\nalpine-baselayout         3.1.2          GPL-2.0-only\nalpine-keys               2.1            MIT\napk-tools                 2.10.4         GPL2 \nbusybox                   1.30.1         GPL-2.0\nca-certificates           20190108       MPL-2.0 GPL-2.0-or-later\nca-certificates-cacert    20190108       MPL-2.0 GPL-2.0-or-later\ncurl                      7.66.0         MIT\nlibc-utils                0.7.1          BSD\nlibcrypto1.1              1.1.1c         OpenSSL\nlibcurl                   7.66.0         MIT\nlibssl1.1                 1.1.1c         OpenSSL\nlibtls-standalone         2.9.1          ISC\nmusl                      1.1.22         MIT\nmusl-utils                1.1.22         MIT BSD GPL2+\nnghttp2-libs              1.39.2         MIT\nscanelf                   1.2.3          GPL-2.0\nssl_client                1.30.1         GPL-2.0\nwget                      1.20.3         GPL-3.0-or-later\nzlib                      1.2.11         zlib\n```", "```\nanchore-cli image vuln vincesestodocker/security-app:scan1 all\n```", "```\nanchore-cli evaluate check vincesestodocker/security-app:scan1\nFrom the output of the above command, it looks like our image \nis safe with a pass result.Image Digest: sha256:7fab55c47c91d7e56f093314ff463b7f97968ee0f80f5ee927430fc\n39f525f66\nFull Tag: docker.io/vincesestodocker/security-app:scan1\nStatus: pass\nLast Eval: 2019-10-24T03:54:40Z\nPolicy ID: 2c53a13c-1765-11e8-82ef-23527761d060\n```", "```\ndocker info\nSecurity Options:\n  apparmor\n  seccomp\n   Profile: default\n```", "```\naa-status\n```", "```\ndocker run --security-opt apparmor=<profile> <image_name>\n```", "```\naa-genprof <application>\n```", "```\napparmor_parser -r -W <path_to_profile>\n```", "```\napparmor_parser -R <path_to_profile>\n```", "```\ndocker info\n…\nSecurity Options:\n  apparmor\n…\n```", "```\n  8 \n  9 #USER 20002\n```", "```\ndocker build -t security-app . ; docker run --rm security-app whoami\n```", "```\nroot\n```", "```\naa-status\n```", "```\napparmor module is loaded.\n15 profiles are loaded.\n15 profiles are in enforce mode.\n    /home/vinces/DockerWork/example.sh\n    /sbin/dhclient\n    /usr/bin/lxc-start\n    /usr/lib/NetworkManager/nm-dhcp-client.action\n    /usr/lib/NetworkManager/nm-dhcp-helper\n    /usr/lib/connman/scripts/dhclient-script\n    /usr/lib/lxd/lxd-bridge-proxy\n    /usr/lib/snapd/snap-confine\n    /usr/lib/snapd/snap-confine//mount-namespace-capture-helper\n    /usr/sbin/tcpdump\n    docker-default\n    lxc-container-default\n    lxc-container-default-cgns\n    lxc-container-default-with-mounting\n    lxc-container-default-with-nesting\n0 profiles are in complain mode.\n1 processes have profiles defined.\n1 processes are in enforce mode.\n    /sbin/dhclient (920) \n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\n```", "```\ndocker run -dit security-app sh\n```", "```\naa-status\n```", "```\napparmor module is loaded.\n…\n2 processes are in enforce mode.\n    /sbin/dhclient (920) \n    docker-default (9768)\n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\n```", "```\ndocker kill $(docker ps -a -q)\n```", "```\ndocker run -dit --security-opt apparmor=unconfined --cap-add SYS_ADMIN security-app sh\n```", "```\ndocker exec -it db04693ddf1f sh\n```", "```\nmkdir 1; mkdir 2; mount --bind 1 2\nls -l\n```", "```\ntotal 8\ndrwxr-xr-x    2 root     root          4096 Nov  4 04:08 1\ndrwxr-xr-x    2 root     root          4096 Nov  4 04:08 2\n```", "```\ndocker kill $(docker ps -a -q)\n```", "```\ndocker run -dit --cap-add SYS_ADMIN security-app sh\n```", "```\ndocker exec -it <new_container_ID> sh \nmkdir 1; mkdir 2; mount --bind 1 2\n```", "```\nmount: mounting 1 on 2 failed: Permission denied\n```", "```\ndocker kill $(docker ps -a -q)\n```", "```\naa-genprof nmap\n```", "```\n…\nProfiling: /usr/bin/nmap\n[(S)can system log for AppArmor events] / (F)inish\n```", "```\ndocker run -it -u root security-app sh -c 'nmap -sS -p 443 localhost'\n```", "```\nReading log entries from /var/log/syslog.\nUpdating AppArmor profiles in /etc/apparmor.d.\n```", "```\n1 # Last Modified: Mon Nov 18 01:03:31 2019\n2 #include <tunables/global>\n3 \n4 /usr/bin/nmap {\n5   #include <abstractions/base>\n6 \n7   /usr/bin/nmap mr,\n8 \n9 }\n```", "```\napparmor_parser -r -W /etc/apparmor.d/usr.bin.nmap\n```", "```\naa-status | grep nmap\n```", "```\n/usr/bin/nmap\n```", "```\ndocker run -it -u root --security-opt apparmor=/usr/bin/nmap security-app sh -c 'nmap -sS -p 443 localhost'\n```", "```\nsh: nmap: Permission denied\n```", "```\ncat /boot/config-'uname -r' | grep CONFIG_SECCOMP=\n```", "```\ndocker run --security-opt seccomp=unconfined <image_name>\n```", "```\ndocker run --security-opt seccomp=new_default.json <image_name>\n```", "```\ncat /boot/config-'uname -r' | grep CONFIG_SECCOMP=\n```", "```\nCONFIG_SECCOMP=y\n```", "```\ndocker info\n```", "```\n…\nSecurity Options:\n  seccomp\n   Profile: default\n…\n```", "```\ndocker run -it security-app grep Seccomp /proc/1/status\n```", "```\nSeccomp:    2\n```", "```\ndocker run -it --security-opt seccomp=unconfined security-app grep Seccomp /proc/1/status\n```", "```\nSeccomp:    0\n```", "```\ndocker run -it security-app sh\n```", "```\n/# touch test.txt\n/# chown 1001 test.txt\n/# ls -l test.txt\n```", "```\n-rw-r--r--    1 1001      users        0 Oct 22 02:44 test.txt\n```", "```\nwget https://raw.githubusercontent.com/docker/docker/v1.12.3/profiles/seccomp/default.json -O new_default.json\n```", "```\n59                 {  \n60                         \"name\": \"chown\",\n61                         \"action\": \"SCMP_ACT_ALLOW\",\n62                         \"args\": []\n63                 },\n```", "```\ndocker run -it --security-opt seccomp=new_default.json security-app sh\n```", "```\n/# touch test.txt\n/# chown 1001 test.txt\nchown: test.txt: Operation not permitted\n```", "```\n$ mkdir test\nmkdir: can't create directory 'test': Operation not permitted\n```", "```\nImage Digest: sha256:57d8817bac132c2fded9127673dd5bc7c3a976546\n36ce35d8f7a05cad37d37b7\nFull Tag: docker.io/dockerrepo/postgres-app:sample_tag\nStatus: pass\nLast Eval: 2019-11-23T06:15:32Z\nPolicy ID: 2c53a13c-1765-11e8-82ef-23527761d060\n```"]